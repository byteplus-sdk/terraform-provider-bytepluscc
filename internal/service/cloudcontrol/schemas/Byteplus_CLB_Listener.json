{
  "additionalProperties": false,
  "createOnlyProperties": [
    "/properties/LoadBalancerId",
    "/properties/Protocol",
    "/properties/Port",
    "/properties/StartPort",
    "/properties/EndPort"
  ],
  "definitions": {
    "HealthCheck": {
      "description": "健康检查相关信息。",
      "properties": {
        "Domain": {
          "description": "健康检查的域名，需配置为后端服务器上真实对外提供服务的地址。当参数Protocol取HTTP或HTTPS，HealthCheck.Enabled取on时，本参数生效。需至少包含一个点号（.），且不允许以点号（.）开头或结尾。单个字符串由母、数字、中划线（-）、点号（.）字符组成，中划线（-）不得出现在字符串的头部或尾部。长度限制为1 ～ 128个字符。不传入该参数或该参数不传入数值时，默认为空，表示CLB使用各后端服务器的私网IP地址进行健康检查。",
          "maxLength": 128,
          "type": "string"
        },
        "Enabled": {
          "default": "on",
          "description": "监听器是否开启健康检查功能。on（默认值）：开启。off：不开启。",
          "enum": [
            "on",
            "off"
          ],
          "type": "string"
        },
        "HealthyThreshold": {
          "default": 3,
          "description": "健康阈值，即连续健康检查成功的次数。取值范围为2 ～ 10，默认值为3，单位为次。",
          "format": "int64",
          "maximum": 10,
          "minimum": 2,
          "type": "integer"
        },
        "HttpCode": {
          "description": "健康检查正常的HTTP状态码。当参数Protocol取HTTP或HTTPS，且HealthCheck.Enabled取on时，参数生效。取值如下：http_2xx （默认值）、http_3xx、http_4xx、http_5xx。多个状态码间用半角逗号“,”分隔。",
          "type": "string"
        },
        "Interval": {
          "default": 2,
          "description": "执行健康检查的时间间隔，取值范围为1 ～ 300 ，默认值为2，单位为秒。",
          "format": "int64",
          "maximum": 300,
          "minimum": 1,
          "type": "integer"
        },
        "Method": {
          "description": "监听器健康检查的方法。GET：服务器需支持GET方法。HEAD：服务器仅返回HEAD头部信息，可以降低后端开销，但要求服务器支持HEAD方法。",
          "enum": [
            "GET",
            "HEAD"
          ],
          "type": "string"
        },
        "Port": {
          "description": "健康检查的端口，取值范围为1-65535。",
          "format": "int64",
          "maximum": 65535,
          "minimum": 0,
          "type": "integer"
        },
        "Timeout": {
          "default": 2,
          "description": "健康检查的响应超时时间，表示如果后端服务器在指定的时间内没有正确响应，则判定为健康检查“异常”。取值范围为1 ～ 60，默认值为2，单位为秒。",
          "format": "int64",
          "maximum": 60,
          "minimum": 1,
          "type": "integer"
        },
        "UdpExpect": {
          "description": "健康检查的预期响应字符串。只允许包含字母和数字，最大长度限制为64个字符。当参数Protocol配置UDP，且参数HealthCheck.Enabled配置为on时，该参数生效。参数HealthCheck.UdpRequest和HealthCheck.UdpExpect的取值只能同时为空或同时不为空。",
          "maxLength": 64,
          "type": "string"
        },
        "UdpRequest": {
          "description": "执行健康检查的请求字符串。只允许包含字母和数字，最大长度限制为64个字。当参数Protocol配置为UDP，且参数HealthCheck.Enabled配置为on时，该参数生效。参数HealthCheck.UdpRequest和HealthCheck.UdpExpect的取值只能同时为空或同时不为空。",
          "maxLength": 64,
          "type": "string"
        },
        "UnhealthyThreshold": {
          "default": 3,
          "description": "不健康阈值，即连续健康检查失败的次数。取值范围为2 ～ 10，默认值为3，单位为次。",
          "format": "int64",
          "maximum": 10,
          "minimum": 2,
          "type": "integer"
        },
        "Uri": {
          "description": "健康检查的路径，需配置为后端服务器上真实对外提供服务的地址。当参数Protocol取HTTP或HTTPS，HealthCheck.Enabled取on时，本参数生效。必须以字符‘/’开头。仅包含字母、数字、中划线（-）、下划线（_）、斜线/）、点号（.）、百分号（%）、英文问号（?）、#、\u0026、等号（＝）字符。长度限制为1 ～ 128个字符。不传入该参数或该参数不传入数值时，默认为“/”。",
          "maxLength": 128,
          "type": "string"
        }
      },
      "type": "object"
    },
    "Tag": {
      "properties": {
        "Key": {
          "description": "用户标签的标签键。长度取值范围为1~128字符，允许输入各国语言文字、数字、空格（ ）、下划线（_）、点号（.）、半角冒号（:）、斜杠（/）、等号（=）、加号（+）、中划线（-）和@（@）。若标签键开头或结尾存在空格，系统会自动为其去除。",
          "maxLength": 128,
          "minLength": 1,
          "type": "string"
        },
        "Value": {
          "description": "用户标签的标签值。允许输入各国语言文字、数字、空格（ ）、下划线（_）、点号（.）、半角冒号（:）、斜杠（/）、等号（=）、加号（+）、中划线（-）和@（@）。大小写敏感。若标签值开头或结尾存在空格，系统会自动为其去除。",
          "maxLength": 256,
          "minLength": 0,
          "type": "string"
        }
      },
      "required": [
        "Key",
        "Value"
      ],
      "type": "object"
    }
  },
  "description": "监听器负责根据指定的协议和端口，监听CLB实例接收到的用户访问请求。CLB将按照该监听器配置的调度算法，将访问请求转发至该后端服务器组内健康的后端服务器。",
  "handlers": {
    "create": {
      "permissions": [
        "clb:CreateListener",
        "clb:DescribeListenerAttributes"
      ]
    },
    "delete": {
      "permissions": [
        "clb:DeleteListener",
        "clb:DescribeListeners"
      ]
    },
    "list": {
      "permissions": [
        "clb:DescribeListeners"
      ]
    },
    "read": {
      "permissions": [
        "clb:DescribeListenerAttributes"
      ]
    },
    "update": {
      "permissions": [
        "clb:ModifyListenerAttributes",
        "clb:DescribeListenerAttributes",
        "clb:TagResources",
        "clb:UntagResources"
      ]
    }
  },
  "primaryIdentifier": [
    "/properties/ListenerId"
  ],
  "properties": {
    "AclIds": {
      "description": "监听器绑定的访问控制策略组ID。仅AclStatus参数为on时返回。",
      "insertionOrder": false,
      "items": {
        "type": "string"
      },
      "type": "array",
      "uniqueItems": true
    },
    "AclStatus": {
      "default": "off",
      "description": "是否开启访问控制功能。取值如下：on：开启。off（默认值）：不开启。",
      "enum": [
        "on",
        "off"
      ],
      "type": "string"
    },
    "AclType": {
      "description": "访问控制的方式。white：白名单。black：黑名单。仅AclStatus参数为on时，本参数有效。",
      "enum": [
        "white",
        "black"
      ],
      "type": "string"
    },
    "Bandwidth": {
      "default": -1,
      "description": "监听器的带宽上限，即此监听器独占CLB实例的带宽，单位为Mbps。-1（默认值）：此监听器不独占CLB的带，与其他监听器共享CLB实例未被独占的带宽。取值范围：1～CLB实例未被独占的带宽。",
      "format": "int64",
      "type": "integer"
    },
    "CACertificateId": {
      "description": "双向认证的CA证书。",
      "type": "string"
    },
    "CAEnabled": {
      "description": "是否开启双向认证。on：开启。off（默认值）：不开启。",
      "enum": [
        "on",
        "off",
        ""
      ],
      "type": "string"
    },
    "CertCenterCertificateId": {
      "description": "证书中心的证书的ID。",
      "type": "string"
    },
    "CertificateId": {
      "description": "CLB侧证书管理模块的证书的ID。",
      "type": "string"
    },
    "CertificateSource": {
      "description": "证书的来源。clb (默认)：CLB上传的证书。cert_center：证书中心上传的证书。user：用户上传的证书。",
      "enum": [
        "clb",
        "cert_center",
        ""
      ],
      "type": "string"
    },
    "ClientBodyTimeout": {
      "description": "读取客户端请求正文的超时时间。此超时时间仅针对两个连续的读操作之间设置，而非整个请求的传输过程。取值范围为 30-120秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效",
      "format": "int64",
      "maximum": 120,
      "minimum": 30,
      "type": "integer"
    },
    "ClientHeaderTimeout": {
      "description": "读取客户端请求头的超时时间。取值范围为30-120秒。默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。",
      "format": "int64",
      "maximum": 120,
      "minimum": 30,
      "type": "integer"
    },
    "ConnectionDrainEnabled": {
      "description": "监听器是否开启连接优雅中断功能。on：开启。off：不开启。参数Protocol返回为HTTP或HTTPS时，该参数固定返回off。",
      "enum": [
        "on",
        "off"
      ],
      "type": "string"
    },
    "ConnectionDrainTimeout": {
      "description": "连接优雅中断的超时时间，单位为秒。参数ConnectionDrainEnabled返回为off时，该参数返回0。",
      "format": "int64",
      "type": "integer"
    },
    "Cookie": {
      "description": "后端服务器配置的会话保持的Cookie名称。仅参数PersistenceType取server时，本参数有效且必填。只能包含字母、数字、下划线（_）和中划线（-）。长度限制在1～200字符之间。",
      "maxLength": 200,
      "type": "string"
    },
    "Cps": {
      "description": "每秒新建连接数的上限。-1（默认值）：不限制，即CLB实例的新建连接数上限。取值范围：1～CLB实例的新连接数上限。",
      "format": "int64",
      "type": "integer"
    },
    "CreatedTime": {
      "description": "监听器的创建时间。",
      "semantic": "createdTime",
      "type": "string"
    },
    "Description": {
      "description": "监听器的描述。必须以字母、数字或中文开头，可包含字母、数字、中文及以下特殊字符：英文逗号（,）、点（.）、下划线（_）、空格（ ）、等号（=）、中划线（-）、中文逗号（，）、中文句号（。）。长度限制为0 ～ 255个字符。不填则默认值为空字符串。",
      "maxLength": 255,
      "minLength": 0,
      "semantic": "description",
      "type": "string"
    },
    "Enabled": {
      "default": "on",
      "description": "是否启用监听器。on（默认值）：开启。off：不开启。",
      "enum": [
        "on",
        "off"
      ],
      "type": "string"
    },
    "EndPort": {
      "description": "全端口监听的结束端口，取值范围为1-65535。参数Port为“0”时，该参数必须传入，且该参数取值应大于tartPort。",
      "format": "int64",
      "maximum": 65535,
      "minimum": 1,
      "type": "integer"
    },
    "EstablishedTimeout": {
      "description": "监听器的连接超时时间。仅参数Protocol取TCP或UDP时，本参数有效。取值如下：TCP协议：10-900秒，默认为900秒。UDP协议：1-300秒，默认为90秒。",
      "format": "int64",
      "type": "integer"
    },
    "HealthCheck": {
      "$ref": "#/definitions/HealthCheck",
      "description": "健康检查相关信息。"
    },
    "Http2Enabled": {
      "description": "监听器是否开启前端HTTP 2.0协议。仅参数`Protocol取HTTPS时，本参数有效。取值如下：|on：开启。off（默认值）：不开启。",
      "enum": [
        "on",
        "off"
      ],
      "type": "string"
    },
    "KeepaliveTimeout": {
      "description": "客户端与CLB之间的长连接超时时间。取值范围为 0-900秒，默认为75秒。0表示禁用长连接。仅参数Protocol取HTTP或HTTPS时，本参数有效。",
      "format": "int64",
      "maximum": 900,
      "minimum": 0,
      "type": "integer"
    },
    "ListenerId": {
      "description": "监听器的ID。",
      "semantic": "resourceId",
      "type": "string"
    },
    "ListenerName": {
      "description": "监听器的名称。必须以字母、数字或中文开头，可包含字母、数字、中文及以下特殊字符：点号（.）、下划线_）和中划线（-）。长度限制在1～128字符之间。不填则默认将“协议-端口”作为监听器名称。",
      "maxLength": 128,
      "minLength": 0,
      "semantic": "resourceName",
      "type": "string"
    },
    "LoadBalancerId": {
      "description": "CLB实例的ID。",
      "type": "string"
    },
    "MaxConnections": {
      "description": "最大并发连接数的上限。-1（默认值）：不限制，CLB实例的最大并发连接数上限。取值范围：1～CLB实例的最大并发连接数上限。",
      "format": "int64",
      "type": "integer"
    },
    "PersistenceTimeout": {
      "description": "会话保持的超时时间，单位为秒。取值范围根据参数PersistenceType取值有所不同。PersistenceType置为source_ip时，取值范围为1～3600。PersistenceType配置为insert时，取值范围为1～86400。",
      "format": "int64",
      "type": "integer"
    },
    "PersistenceType": {
      "default": "off",
      "description": "会话保持的类型。取值如下：off（默认值）：不启用会话保持。source_ip：源地址IP，仅参数ProtocolTCP或UDP时，本取值有效。insert：植入Cookie，仅参数Protocol取HTTP或HTTPS且Scheduler取wrr时，本取值生效。server：重写Cookie，仅参数Protocol取HTTP或HTTPS且Scheduler取wrr时，本取值生效。。",
      "enum": [
        "off",
        "source_ip",
        "insert",
        "server"
      ],
      "type": "string"
    },
    "Port": {
      "description": "监听器接收请求使用的端口。取值范围为 0～65535。参数Protocol为“TCP”或“UDP”时，支持传入0，表示用全端口监听。",
      "format": "int64",
      "maximum": 65535,
      "minimum": 0,
      "type": "integer"
    },
    "Protocol": {
      "description": "监听器的协议。",
      "enum": [
        "TCP",
        "UDP",
        "HTTP",
        "HTTPS"
      ],
      "type": "string"
    },
    "ProxyConnectTimeout": {
      "description": "CLB与后端服务器之间的连接建立超时时间。建议大于健康检查超时时间。取值范围为 4-120秒，默认为4。仅参数Protocol取HTTP或HTTPS时，本参数有效。",
      "format": "int64",
      "maximum": 120,
      "minimum": 4,
      "type": "integer"
    },
    "ProxyProtocolType": {
      "description": "是否启用Proxy-Protocol协议。仅参数Protocol取TCP或UDP时，本参数有效。取值如下：off（默认值）：关闭。standard：开启。",
      "enum": [
        "off",
        "standard"
      ],
      "type": "string"
    },
    "ProxyReadTimeout": {
      "description": "CLB从后端服务器读取响应的超时时间。此超时时间仅针对两个连续的读操作之间设置，而非整个响应的传输过程。取值范围为30-3600秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。",
      "format": "int64",
      "maximum": 3600,
      "minimum": 30,
      "type": "integer"
    },
    "ProxySendTimeout": {
      "description": "CLB将请求传输到后端服务器的超时时间。此超时仅针对两个连续的写操作之间设置，而非整个请求的传输过程。取值范围为30-3600秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。",
      "format": "int64",
      "maximum": 3600,
      "minimum": 30,
      "type": "integer"
    },
    "Scheduler": {
      "default": "wrr",
      "description": "监听器使用的调度算法。wrr（默认值）：加权轮询。wlc：加权最小连接数。sh：源地址哈希。",
      "enum": [
        "wrr",
        "wlc",
        "sh"
      ],
      "type": "string"
    },
    "SecurityPolicyId": {
      "description": "HTTPS监听器的TLS安全策略。仅参数Protocol取HTTPS时，本参数有效。 取值如下：default_policy（默认值）：支持SSL v3、TLS v1.0、TLS v1.1、TLS v1.2。tls_cipher_policy_1_0：支持TLS v1.0、TLS v1.1、TLS v1.2。tls_cipher_policy_1_1：支持TLS v1.1、TLS v1.2。tls_cipher_policy_1_2：支持TLS v1.2。tls_cipher_policy_1_2_strict：支持TLS v1.2。",
      "type": "string"
    },
    "SendTimeout": {
      "description": "CLB向客户端发送响应的超时时间。此超时仅针对两个连续的写操作之间设置，而非整响应的传输过程。取值范围为 1-3600秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。",
      "format": "int64",
      "maximum": 3600,
      "minimum": 1,
      "type": "integer"
    },
    "ServerGroupId": {
      "description": "监听器关联的后端服务器组 ID。",
      "type": "string"
    },
    "StartPort": {
      "description": "全端口监听的起始端口，取值范围为1-65535。参数Port为“0”时，该参数必须传入。",
      "format": "int64",
      "maximum": 65535,
      "minimum": 1,
      "type": "integer"
    },
    "Status": {
      "description": "监听器的状态。Creating：创建中。Active：运行中。Deleting: 删除中。Disabled: 已停用。",
      "enum": [
        "Creating",
        "Active",
        "Deleting",
        "Disabled"
      ],
      "type": "string"
    },
    "Tags": {
      "description": "监听器所属标签。",
      "insertionOrder": false,
      "items": {
        "$ref": "#/definitions/Tag"
      },
      "maxItems": 50,
      "semantic": "tags",
      "type": "array",
      "uniqueItems": true
    },
    "UpdatedTime": {
      "description": "监听器最近一次的操作时间。",
      "semantic": "updatedTime",
      "type": "string"
    },
    "WafProtectionEnabled": {
      "description": "是否将经过七层监听器的流量送至Web应用防火墙进行检测和过滤。on：是。off：否。",
      "enum": [
        "on",
        "off"
      ],
      "type": "string"
    }
  },
  "readOnlyProperties": [
    "/properties/ListenerId",
    "/properties/CreatedTime",
    "/properties/UpdatedTime",
    "/properties/Status",
    "/properties/WafProtectionEnabled"
  ],
  "required": [
    "Protocol",
    "Port",
    "LoadBalancerId",
    "ServerGroupId"
  ],
  "tagging": {
    "tagOnCreate": true,
    "tagUpdatable": true,
    "taggable": true
  },
  "typeName": "Byteplus::CLB::Listener"
}