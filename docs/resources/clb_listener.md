---
page_title: "bytepluscc_clb_listener Resource - terraform-provider-bytepluscc"
subcategory: ""
description: |-
  监听器负责根据指定的协议和端口，监听CLB实例接收到的用户访问请求。CLB将按照该监听器配置的调度算法，将访问请求转发至该后端服务器组内健康的后端服务器。
---

# bytepluscc_clb_listener (Resource)

监听器负责根据指定的协议和端口，监听CLB实例接收到的用户访问请求。CLB将按照该监听器配置的调度算法，将访问请求转发至该后端服务器组内健康的后端服务器。

## Example Usage

```terraform
resource "bytepluscc_clb_listener" "ClbListenerDemo" {
  acl_ids                  = ["acl-mjd01crvppts5smt1bsxxxxx"]
  acl_status               = "on"
  acl_type                 = "black"
  connection_drain_enabled = "on"
  connection_drain_timeout = 900
  description              = "ClbListenerDemo description"
  enabled                  = "on"
  established_timeout      = 300
  server_group_id          = "rsp-rs11ie8u6neov0x58bxxxxx"
  health_check = {
    enabled             = "on"
    healthy_threshold   = 3
    interval            = 5
    timeout             = 2
    unhealthy_threshold = 3
    port                = 0
    udp_request         = "test"
    udp_expect          = "test"
  }
  listener_name       = "ClbListenerDemo"
  load_balancer_id    = "clb-rs1187938g00v0x58nxxxxx"
  persistence_timeout = 1000
  persistence_type    = "source_ip"
  protocol            = "UDP"
  port                = 5001
  scheduler           = "wrr"
  bandwidth           = 1
  proxy_protocol_type = "standard"
  tags = [
    {
      key = "env"
    value = "test" }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `load_balancer_id` (String) CLB实例的ID。
- `port` (Number) 监听器接收请求使用的端口。取值范围为 0～65535。参数Protocol为“TCP”或“UDP”时，支持传入0，表示用全端口监听。
- `protocol` (String) 监听器的协议。
- `server_group_id` (String) 监听器关联的后端服务器组 ID。

### Optional

- `acl_ids` (Set of String) 监听器绑定的访问控制策略组ID。仅AclStatus参数为on时返回。
- `acl_status` (String) 是否开启访问控制功能。取值如下：on：开启。off（默认值）：不开启。
- `acl_type` (String) 访问控制的方式。white：白名单。black：黑名单。仅AclStatus参数为on时，本参数有效。
- `bandwidth` (Number) 监听器的带宽上限，即此监听器独占CLB实例的带宽，单位为Mbps。-1（默认值）：此监听器不独占CLB的带，与其他监听器共享CLB实例未被独占的带宽。取值范围：1～CLB实例未被独占的带宽。
- `ca_certificate_id` (String) 双向认证的CA证书。
- `ca_enabled` (String) 是否开启双向认证。on：开启。off（默认值）：不开启。
- `cert_center_certificate_id` (String) 证书中心的证书的ID。
- `certificate_id` (String) CLB侧证书管理模块的证书的ID。
- `certificate_source` (String) 证书的来源。clb (默认)：CLB上传的证书。cert_center：证书中心上传的证书。user：用户上传的证书。
- `client_body_timeout` (Number) 读取客户端请求正文的超时时间。此超时时间仅针对两个连续的读操作之间设置，而非整个请求的传输过程。取值范围为 30-120秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效
- `client_header_timeout` (Number) 读取客户端请求头的超时时间。取值范围为30-120秒。默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。
- `connection_drain_enabled` (String) 监听器是否开启连接优雅中断功能。on：开启。off：不开启。参数Protocol返回为HTTP或HTTPS时，该参数固定返回off。
- `connection_drain_timeout` (Number) 连接优雅中断的超时时间，单位为秒。参数ConnectionDrainEnabled返回为off时，该参数返回0。
- `cookie` (String) 后端服务器配置的会话保持的Cookie名称。仅参数PersistenceType取server时，本参数有效且必填。只能包含字母、数字、下划线（_）和中划线（-）。长度限制在1～200字符之间。
- `cps` (Number) 每秒新建连接数的上限。-1（默认值）：不限制，即CLB实例的新建连接数上限。取值范围：1～CLB实例的新连接数上限。
- `description` (String) 监听器的描述。必须以字母、数字或中文开头，可包含字母、数字、中文及以下特殊字符：英文逗号（,）、点（.）、下划线（_）、空格（ ）、等号（=）、中划线（-）、中文逗号（，）、中文句号（。）。长度限制为0 ～ 255个字符。不填则默认值为空字符串。
- `enabled` (String) 是否启用监听器。on（默认值）：开启。off：不开启。
- `end_port` (Number) 全端口监听的结束端口，取值范围为1-65535。参数Port为“0”时，该参数必须传入，且该参数取值应大于tartPort。
- `established_timeout` (Number) 监听器的连接超时时间。仅参数Protocol取TCP或UDP时，本参数有效。取值如下：TCP协议：10-900秒，默认为900秒。UDP协议：1-300秒，默认为90秒。
- `health_check` (Attributes) 健康检查相关信息。 (see [below for nested schema](#nestedatt--health_check))
- `http_2_enabled` (String) 监听器是否开启前端HTTP 2.0协议。仅参数`Protocol取HTTPS时，本参数有效。取值如下：|on：开启。off（默认值）：不开启。
- `keepalive_timeout` (Number) 客户端与CLB之间的长连接超时时间。取值范围为 0-900秒，默认为75秒。0表示禁用长连接。仅参数Protocol取HTTP或HTTPS时，本参数有效。
- `listener_name` (String) 监听器的名称。必须以字母、数字或中文开头，可包含字母、数字、中文及以下特殊字符：点号（.）、下划线_）和中划线（-）。长度限制在1～128字符之间。不填则默认将“协议-端口”作为监听器名称。
- `max_connections` (Number) 最大并发连接数的上限。-1（默认值）：不限制，CLB实例的最大并发连接数上限。取值范围：1～CLB实例的最大并发连接数上限。
- `persistence_timeout` (Number) 会话保持的超时时间，单位为秒。取值范围根据参数PersistenceType取值有所不同。PersistenceType置为source_ip时，取值范围为1～3600。PersistenceType配置为insert时，取值范围为1～86400。
- `persistence_type` (String) 会话保持的类型。取值如下：off（默认值）：不启用会话保持。source_ip：源地址IP，仅参数ProtocolTCP或UDP时，本取值有效。insert：植入Cookie，仅参数Protocol取HTTP或HTTPS且Scheduler取wrr时，本取值生效。server：重写Cookie，仅参数Protocol取HTTP或HTTPS且Scheduler取wrr时，本取值生效。。
- `proxy_connect_timeout` (Number) CLB与后端服务器之间的连接建立超时时间。建议大于健康检查超时时间。取值范围为 4-120秒，默认为4。仅参数Protocol取HTTP或HTTPS时，本参数有效。
- `proxy_protocol_type` (String) 是否启用Proxy-Protocol协议。仅参数Protocol取TCP或UDP时，本参数有效。取值如下：off（默认值）：关闭。standard：开启。
- `proxy_read_timeout` (Number) CLB从后端服务器读取响应的超时时间。此超时时间仅针对两个连续的读操作之间设置，而非整个响应的传输过程。取值范围为30-3600秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。
- `proxy_send_timeout` (Number) CLB将请求传输到后端服务器的超时时间。此超时仅针对两个连续的写操作之间设置，而非整个请求的传输过程。取值范围为30-3600秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。
- `scheduler` (String) 监听器使用的调度算法。wrr（默认值）：加权轮询。wlc：加权最小连接数。sh：源地址哈希。
- `security_policy_id` (String) HTTPS监听器的TLS安全策略。仅参数Protocol取HTTPS时，本参数有效。 取值如下：default_policy（默认值）：支持SSL v3、TLS v1.0、TLS v1.1、TLS v1.2。tls_cipher_policy_1_0：支持TLS v1.0、TLS v1.1、TLS v1.2。tls_cipher_policy_1_1：支持TLS v1.1、TLS v1.2。tls_cipher_policy_1_2：支持TLS v1.2。tls_cipher_policy_1_2_strict：支持TLS v1.2。
- `send_timeout` (Number) CLB向客户端发送响应的超时时间。此超时仅针对两个连续的写操作之间设置，而非整响应的传输过程。取值范围为 1-3600秒，默认为60秒。仅参数Protocol取HTTP或HTTPS时，本参数有效。
- `start_port` (Number) 全端口监听的起始端口，取值范围为1-65535。参数Port为“0”时，该参数必须传入。
- `tags` (Attributes Set) 监听器所属标签。
 特别提示: 在使用 ListNestedAttribute 或 SetNestedAttribute 时，必须完整定义其嵌套结构体的所有属性。若定义不完整，Terraform 在执行计划对比时可能会检测到意料之外的差异，从而触发不必要的资源更新，影响资源的稳定性与可预测性。 (see [below for nested schema](#nestedatt--tags))

### Read-Only

- `created_time` (String) 监听器的创建时间。
- `id` (String) Uniquely identifies the resource.
- `listener_id` (String) 监听器的ID。
- `status` (String) 监听器的状态。Creating：创建中。Active：运行中。Deleting: 删除中。Disabled: 已停用。
- `updated_time` (String) 监听器最近一次的操作时间。
- `waf_protection_enabled` (String) 是否将经过七层监听器的流量送至Web应用防火墙进行检测和过滤。on：是。off：否。

<a id="nestedatt--health_check"></a>
### Nested Schema for `health_check`

Optional:

- `domain` (String) 健康检查的域名，需配置为后端服务器上真实对外提供服务的地址。当参数Protocol取HTTP或HTTPS，HealthCheck.Enabled取on时，本参数生效。需至少包含一个点号（.），且不允许以点号（.）开头或结尾。单个字符串由母、数字、中划线（-）、点号（.）字符组成，中划线（-）不得出现在字符串的头部或尾部。长度限制为1 ～ 128个字符。不传入该参数或该参数不传入数值时，默认为空，表示CLB使用各后端服务器的私网IP地址进行健康检查。
- `enabled` (String) 监听器是否开启健康检查功能。on（默认值）：开启。off：不开启。
- `healthy_threshold` (Number) 健康阈值，即连续健康检查成功的次数。取值范围为2 ～ 10，默认值为3，单位为次。
- `http_code` (String) 健康检查正常的HTTP状态码。当参数Protocol取HTTP或HTTPS，且HealthCheck.Enabled取on时，参数生效。取值如下：http_2xx （默认值）、http_3xx、http_4xx、http_5xx。多个状态码间用半角逗号“,”分隔。
- `interval` (Number) 执行健康检查的时间间隔，取值范围为1 ～ 300 ，默认值为2，单位为秒。
- `method` (String) 监听器健康检查的方法。GET：服务器需支持GET方法。HEAD：服务器仅返回HEAD头部信息，可以降低后端开销，但要求服务器支持HEAD方法。
- `port` (Number) 健康检查的端口，取值范围为1-65535。
- `timeout` (Number) 健康检查的响应超时时间，表示如果后端服务器在指定的时间内没有正确响应，则判定为健康检查“异常”。取值范围为1 ～ 60，默认值为2，单位为秒。
- `udp_expect` (String) 健康检查的预期响应字符串。只允许包含字母和数字，最大长度限制为64个字符。当参数Protocol配置UDP，且参数HealthCheck.Enabled配置为on时，该参数生效。参数HealthCheck.UdpRequest和HealthCheck.UdpExpect的取值只能同时为空或同时不为空。
- `udp_request` (String) 执行健康检查的请求字符串。只允许包含字母和数字，最大长度限制为64个字。当参数Protocol配置为UDP，且参数HealthCheck.Enabled配置为on时，该参数生效。参数HealthCheck.UdpRequest和HealthCheck.UdpExpect的取值只能同时为空或同时不为空。
- `unhealthy_threshold` (Number) 不健康阈值，即连续健康检查失败的次数。取值范围为2 ～ 10，默认值为3，单位为次。
- `uri` (String) 健康检查的路径，需配置为后端服务器上真实对外提供服务的地址。当参数Protocol取HTTP或HTTPS，HealthCheck.Enabled取on时，本参数生效。必须以字符‘/’开头。仅包含字母、数字、中划线（-）、下划线（_）、斜线/）、点号（.）、百分号（%）、英文问号（?）、#、&、等号（＝）字符。长度限制为1 ～ 128个字符。不传入该参数或该参数不传入数值时，默认为“/”。


<a id="nestedatt--tags"></a>
### Nested Schema for `tags`

Optional:

- `key` (String) 用户标签的标签键。长度取值范围为1~128字符，允许输入各国语言文字、数字、空格（ ）、下划线（_）、点号（.）、半角冒号（:）、斜杠（/）、等号（=）、加号（+）、中划线（-）和@（@）。若标签键开头或结尾存在空格，系统会自动为其去除。
- `value` (String) 用户标签的标签值。允许输入各国语言文字、数字、空格（ ）、下划线（_）、点号（.）、半角冒号（:）、斜杠（/）、等号（=）、加号（+）、中划线（-）和@（@）。大小写敏感。若标签值开头或结尾存在空格，系统会自动为其去除。

## Import

Import is supported using the following syntax:

```shell
$ terraform import bytepluscc_clb_listener.example "listener_id"
```